import{D as te}from"./index.be83d125.js";import{_ as j,e as le}from"./index.92839dfe.js";import{h as I,k as u,z as se,o as y,m as x,D as e,J as U,u as F,y as V,I as $,O as ae,b as X,f as ne,c as oe,w as ie,F as Y,G as W,H as O,a as H,K as re,L as ce,N as ue}from"./elementPlus.307743df.js";const de={__name:"Slider",props:{modelValue:Number,min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},vertical:{type:Boolean,default:!1}},emits:["update:modelValue","change","drag"],setup(g,{emit:b}){const l=g,o=I(()=>l.vertical?{height:_.value}:{width:_.value}),i=I(()=>l.vertical?{bottom:_.value}:{left:_.value}),r=u(null),t=u(null),_=I(()=>(l.modelValue*100/(l.max-l.min)).toFixed(2)+"%"),S=I(()=>{const a=[l.min,l.max,l.step].map(m=>{const f=`${m}`.split(".")[1];return f?f.length:0});return Math.max.apply(null,a)}),n={};let p=0;se(()=>{const{offsetWidth:a,offsetHeight:m}=r.value;p=l.vertical?m:a});const N=a=>{a.preventDefault(),n.start=l.vertical?a.clientY:a.clientX,n.startPosition=l.modelValue/(l.max-l.min)*p,window.addEventListener("mousemove",v),window.addEventListener("mouseup",d),b("drag")},d=()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",d),b("change",l.modelValue)},v=a=>{let m=a||window.event,f=l.vertical?n.start-m.clientY:m.clientX-n.start,C=n.startPosition+f;D(C)},k=u(null),M=a=>{let m=l.vertical?k.value.getBoundingClientRect().bottom-a.clientY:a.clientX-k.value.getBoundingClientRect().left;const f=D(m);b("change",f)},D=a=>{a<0&&(a=0),a>=p&&(a=p);const m=(l.max-l.min)/l.step;let C=Math.round(a/p*m)*l.step+l.min;return C=Number.parseFloat(C.toFixed(S.value)),b("update:modelValue",C),C};return(a,m)=>(y(),x("div",{class:V([g.vertical?"slider-vertical":"slider"]),ref_key:"slider",ref:k},[e("div",{class:"slider-runway",onClick:M,ref_key:"runway",ref:r},[e("div",{class:"slider-bar",style:U(F(o))},null,4),e("div",{class:"slider-dot",style:U(F(i)),onMousedown:N,ref_key:"dot",ref:t},null,36)],512)],2))}},q=j(de,[["__scopeId","data-v-6dd58f88"]]);const ve={class:"scroll-wrap"},pe={class:"scroll-item"},me={__name:"AutoScrollText",props:{text:String},setup(g){return(b,l)=>(y(),x("div",ve,[e("div",pe,$(g.text),1)]))}},G=j(me,[["__scopeId","data-v-c505a789"]]);function _e(g,b){const l=o=>{const i={ti:"",ar:"",al:"",by:"",offset:0,ms:[]};if(o.length==0)return;const r=o.split(`
`);for(let t in r){r[t]=r[t].replace(/(^\s*)|(\s*$)/g,"");let S=r[t].substring(r[t].indexOf("[")+1,r[t].indexOf("]")).split(":");if(isNaN(parseInt(S[0])))for(let n in i)n!="ms"&&n==S[0].toLowerCase()&&(i[n]=S[1]);else{const n=r[t].match(/\[(\d+:.+?)\]/g);let p=0;for(let d in n)p+=n[d].length;let N=r[t].substring(p);for(let d in n){let k=n[d].substring(1,n[d].length-1).split(":");N&&i.ms.push({t:(parseFloat(k[0])*60+parseFloat(k[1])).toFixed(3),c:N})}}}return i.ms.sort(function(t,_){return t.t-_.t}),i};return new Promise((o,i)=>{le.get(b).then(({data:r})=>{let t=l(r);o(t)}).catch(r=>{i(r)})})}const fe=g=>(re("data-v-285954f0"),g=g(),ce(),g),he={class:"music-container"},ye=fe(()=>e("div",{class:"header flex-box flex-v-center"},[e("span",{class:"logo iconfont icon-music"}),ue(" \u97F3\u4E50\u64AD\u653E\u5668 ")],-1)),ge={class:"content"},xe={class:"playlist-item-name"},be={class:"playlist-item-author"},ke=["onClick","title"],we={class:"disc flex-box flex-v-center flex-h-center"},Ce={class:"disc-outer flex-box flex-v-center flex-h-center"},Se={class:"disc-inner"},Ve=["src"],Ie={class:"footer"},Ne={class:"music-info"},De={class:"song-name"},Le={class:"song-singer"},Te={class:"music-duration"},Pe={class:"progress"},$e={class:"controls flex-box flex-v-center flex-h-between"},Fe=["title"],Me={class:"volume"},Be={key:0,class:"volume-controls"},Ee=["src"],Oe={__name:"index",setup(g){const b={title:"\u97F3\u4E50\u64AD\u653E\u5668",url:""},{proxy:l}=ae(),o=u([]),i=u(0),r=()=>{i.value===1?i.value=2:i.value=1};l.req({url:"/demo/playlist"}).then(s=>{o.value=s.result.list});const t=u(0),_=u(0),S=I(()=>R(_.value)),n=u(0),p=u(0),N=I(()=>R(p.value)),d=u(!0),v=u(null),k=s=>{typeof s<"u"&&(t.value=s),v.value.paused?(v.value.play(),B.value=!0):(v.value.pause(),d.value=v.value.paused),z.value=!1},M=u(.2);X(M,s=>{v.value&&(v.value.volume=s)},{immediate:!0});const D=u(!1),a=s=>{D.value=!0},m=s=>{v.value.currentTime=s,D.value=!1},f=u(!1),C=()=>{f.value=!f.value},R=s=>{let c=Math.floor(s/60),w=Math.floor(s%60);return c=String(c).padStart(2,"0"),w=String(w).padStart(2,"0"),`${c}:${w}`};let L=ne({ms:[],al:"",ar:"",by:"",offset:0,ti:""});const z=u(!0),B=u(!1),J=()=>{_.value=Math.round(v.value.duration),_e("",o.value[t.value].lyricUrl).then(s=>{if(s)for(let c in s)L[c]=s[c]}),z.value||(v.value.play(),B.value=!0)},T=u(0);X(n,s=>{if(L.ms&&s>0){const c=L.ms.length;if(s>parseFloat(L.ms[c-1].t))T.value=c-1;else if(T.value<c-2){let w=L.ms.findIndex(E=>s<E.t);w>0&&(T.value=w-1)}}});const K=I(()=>{if(T.value*30>=150)return-(T.value*30-150)+"px"}),Q=()=>{if(D.value)return;let s=Math.round(v.value.currentTime);p.value=s,n.value=s,d.value=v.value.paused},Z=()=>{d.value=!0,n.value=0,B.value=!1,A()},A=()=>{t.value<o.value.length-1?t.value++:t.value=0},ee=()=>{t.value>0?t.value--:t.value=o.value.length-1};return(s,c)=>(y(),oe(te,{data:b},{default:ie(()=>{var w,E;return[e("div",he,[ye,e("div",ge,[i.value!==0?(y(),x("div",{key:0,class:V(["playlist animate__animated animate__faster",{playlist__hidden:i.value===0,animate__slideInLeft:i.value===1,animate__slideOutLeft:i.value===2}])},[(y(!0),x(Y,null,W(o.value,(h,P)=>(y(),x("div",{class:V(["playlist-item flex-box flex-v-center",{"playlist-item-active":t.value===P}]),key:h.url},[e("div",xe,[H(G,{text:h.name},null,8,["text"])]),e("div",be,[H(G,{text:h.author},null,8,["text"])]),e("span",{class:V(["play-btn iconfont",t.value!==P||d.value?"icon-play":"icon-pause"]),onClick:He=>k(P),title:t.value!==P||d.value?"\u64AD\u653E":"\u6682\u505C"},null,10,ke)],2))),128))],2)):O("",!0),e("div",we,[e("div",Ce,[e("div",Se,[o.value[t.value]?(y(),x("img",{key:0,src:o.value[t.value].coverUrl,class:V(["cover-img",{"cover-img-rotate":B.value,"cover-img-rotate-paused":d.value}]),alt:""},null,10,Ve)):O("",!0)])])]),e("div",{class:"lyric",style:U({marginTop:F(K)})},[(y(!0),x(Y,null,W(F(L).ms,(h,P)=>(y(),x("p",{class:V(["lyric-text",T.value===P?"lyric-text-current":""]),key:h.t},$(h.c),3))),128))],4)]),e("div",Ie,[e("div",Ne,[e("div",null,[e("span",De,$((w=o.value[t.value])==null?void 0:w.name),1),e("span",Le," - "+$((E=o.value[t.value])==null?void 0:E.author),1)]),e("div",Te,[e("span",null,$(F(N)),1),e("span",null," / "+$(F(S)),1)])]),e("div",Pe,[H(q,{modelValue:p.value,"onUpdate:modelValue":c[0]||(c[0]=h=>p.value=h),max:_.value,onChange:m,onDrag:a},null,8,["modelValue","max"])]),e("div",$e,[e("div",{class:"playlist-btn iconfont icon-playlist",title:"\u64AD\u653E\u5217\u8868",onClick:r}),e("div",null,[e("span",{class:"prev iconfont icon-prev",title:"\u4E0A\u4E00\u9996",onClick:ee}),e("span",{class:V(["switch iconfont",d.value?"icon-play":"icon-pause"]),onClick:c[1]||(c[1]=h=>k()),title:d.value?"\u64AD\u653E":"\u6682\u505C"},null,10,Fe),e("span",{class:"next iconfont icon-next",title:"\u4E0B\u4E00\u9996",onClick:A})]),e("div",Me,[e("span",{class:"volume-icon iconfont icon-volume",onClick:C}),f.value?(y(),x("div",Be,[H(q,{modelValue:M.value,"onUpdate:modelValue":c[2]||(c[2]=h=>M.value=h),max:1,step:.1,vertical:""},null,8,["modelValue","step"])])):O("",!0)])])]),o.value.length>0?(y(),x("audio",{key:0,ref_key:"audio",ref:v,onCanplay:J,onTimeupdate:Q,onEnded:Z,src:o.value[t.value].url},null,40,Ee)):O("",!0)])]}),_:1}))}},ze=j(Oe,[["__scopeId","data-v-285954f0"]]);export{ze as default};
