import{D as te}from"./index.e28c225b.js";import{_ as G,e as le}from"./index.20b757df.js";import{h as I,k as c,A as se,o as y,m as b,z as e,K as U,u as T,y as S,P as ae,b as A,f as ne,c as oe,w as ie,G as X,H as Y,I as $,J as B,a as H,L as re,M as ue,O as ce}from"./elementPlus.8e3ee12e.js";import{A as W}from"./AutoScrollText.0abb98c4.js";const de={__name:"Slider",props:{modelValue:Number,min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},vertical:{type:Boolean,default:!1}},emits:["update:modelValue","change","drag"],setup(k,{emit:w}){const l=k,o=I(()=>l.vertical?{height:f.value}:{width:f.value}),i=I(()=>l.vertical?{bottom:f.value}:{left:f.value}),r=c(null),t=c(null),f=I(()=>(l.modelValue*100/(l.max-l.min)).toFixed(2)+"%"),V=I(()=>{const a=[l.min,l.max,l.step].map(p=>{const _=`${p}`.split(".")[1];return _?_.length:0});return Math.max.apply(null,a)}),n={};let m=0;se(()=>{const{offsetWidth:a,offsetHeight:p}=r.value;m=l.vertical?p:a});const N=a=>{a.preventDefault(),n.start=l.vertical?a.clientY:a.clientX,n.startPosition=l.modelValue/(l.max-l.min)*m,window.addEventListener("mousemove",v),window.addEventListener("mouseup",d),w("drag")},d=()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",d),w("change",l.modelValue)},v=a=>{let p=a||window.event,_=l.vertical?n.start-p.clientY:p.clientX-n.start,C=n.startPosition+_;L(C)},g=c(null),F=a=>{let p=l.vertical?g.value.getBoundingClientRect().bottom-a.clientY:a.clientX-g.value.getBoundingClientRect().left;const _=L(p);w("change",_)},L=a=>{a<0&&(a=0),a>=m&&(a=m);const p=(l.max-l.min)/l.step;let C=Math.round(a/m*p)*l.step+l.min;return C=Number.parseFloat(C.toFixed(V.value)),w("update:modelValue",C),C};return(a,p)=>(y(),b("div",{class:S([k.vertical?"slider-vertical":"slider"]),ref_key:"slider",ref:g},[e("div",{class:"slider-runway",onClick:F,ref_key:"runway",ref:r},[e("div",{class:"slider-bar",style:U(T(o))},null,4),e("div",{class:"slider-dot",style:U(T(i)),onMousedown:N,ref_key:"dot",ref:t},null,36)],512)],2))}},q=G(de,[["__scopeId","data-v-6dd58f88"]]);function ve(k,w){const l=o=>{const i={ti:"",ar:"",al:"",by:"",offset:0,ms:[]};if(o.length==0)return;const r=o.split(`
`);for(let t in r){r[t]=r[t].replace(/(^\s*)|(\s*$)/g,"");let V=r[t].substring(r[t].indexOf("[")+1,r[t].indexOf("]")).split(":");if(isNaN(parseInt(V[0])))for(let n in i)n!="ms"&&n==V[0].toLowerCase()&&(i[n]=V[1]);else{const n=r[t].match(/\[(\d+:.+?)\]/g);let m=0;for(let d in n)m+=n[d].length;let N=r[t].substring(m);for(let d in n){let g=n[d].substring(1,n[d].length-1).split(":");N&&i.ms.push({t:(parseFloat(g[0])*60+parseFloat(g[1])).toFixed(3),c:N})}}}return i.ms.sort(function(t,f){return t.t-f.t}),i};return new Promise((o,i)=>{le.get(w).then(({data:r})=>{let t=l(r);o(t)}).catch(r=>{i(r)})})}const me=k=>(re("data-v-285954f0"),k=k(),ue(),k),pe={class:"music-container"},fe=me(()=>e("div",{class:"header flex-box flex-v-center"},[e("span",{class:"logo iconfont icon-music"}),ce(" \u97F3\u4E50\u64AD\u653E\u5668 ")],-1)),_e={class:"content"},he={class:"playlist-item-name"},ye={class:"playlist-item-author"},ge=["onClick","title"],xe={class:"disc flex-box flex-v-center flex-h-center"},be={class:"disc-outer flex-box flex-v-center flex-h-center"},ke={class:"disc-inner"},we=["src"],Ce={class:"footer"},Ve={class:"music-info"},Se={class:"song-name"},Ie={class:"song-singer"},Ne={class:"music-duration"},Le={class:"progress"},De={class:"controls flex-box flex-v-center flex-h-between"},Pe=["title"],Me={class:"volume"},Te={key:0,class:"volume-controls"},Fe=["src"],Be={__name:"index",setup(k){const w={title:"\u97F3\u4E50\u64AD\u653E\u5668",url:""},{proxy:l}=ae(),o=c([]),i=c(0),r=()=>{i.value===1?i.value=2:i.value=1};l.req({url:"/demo/playlist"}).then(s=>{o.value=s.result.list});const t=c(0),f=c(0),V=I(()=>j(f.value)),n=c(0),m=c(0),N=I(()=>j(m.value)),d=c(!0),v=c(null),g=s=>{typeof s<"u"&&(t.value=s),v.value.paused?(v.value.play(),E.value=!0):(v.value.pause(),d.value=v.value.paused),R.value=!1},F=c(.2);A(F,s=>{v.value&&(v.value.volume=s)},{immediate:!0});const L=c(!1),a=s=>{L.value=!0},p=s=>{v.value.currentTime=s,L.value=!1},_=c(!1),C=()=>{_.value=!_.value},j=s=>{let u=Math.floor(s/60),x=Math.floor(s%60);return u=String(u).padStart(2,"0"),x=String(x).padStart(2,"0"),`${u}:${x}`};let D=ne({ms:[],al:"",ar:"",by:"",offset:0,ti:""});const R=c(!0),E=c(!1),J=()=>{f.value=Math.round(v.value.duration),ve("",o.value[t.value].lyricUrl).then(s=>{if(s)for(let u in s)D[u]=s[u]}),R.value||(v.value.play(),E.value=!0)},P=c(0);A(n,s=>{if(D.ms&&s>0){const u=D.ms.length;if(s>parseFloat(D.ms[u-1].t))P.value=u-1;else if(P.value<u-2){let x=D.ms.findIndex(O=>s<O.t);x>0&&(P.value=x-1)}}});const K=I(()=>{if(P.value*30>=150)return-(P.value*30-150)+"px"}),Q=()=>{if(L.value)return;let s=Math.round(v.value.currentTime);m.value=s,n.value=s,d.value=v.value.paused},Z=()=>{d.value=!0,n.value=0,E.value=!1,z()},z=()=>{t.value<o.value.length-1?t.value++:t.value=0},ee=()=>{t.value>0?t.value--:t.value=o.value.length-1};return(s,u)=>(y(),oe(te,{data:w},{default:ie(()=>{var x,O;return[e("div",pe,[fe,e("div",_e,[i.value!==0?(y(),b("div",{key:0,class:S(["playlist animate__animated animate__faster",{playlist__hidden:i.value===0,animate__slideInLeft:i.value===1,animate__slideOutLeft:i.value===2}])},[(y(!0),b(X,null,Y(o.value,(h,M)=>(y(),b("div",{class:S(["playlist-item flex-box flex-v-center",{"playlist-item-active":t.value===M}]),key:h.url},[e("div",he,[H(W,{text:h.name},null,8,["text"])]),e("div",ye,[H(W,{text:h.author},null,8,["text"])]),e("span",{class:S(["play-btn iconfont",t.value!==M||d.value?"icon-play":"icon-pause"]),onClick:Ee=>g(M),title:t.value!==M||d.value?"\u64AD\u653E":"\u6682\u505C"},null,10,ge)],2))),128))],2)):$("",!0),e("div",xe,[e("div",be,[e("div",ke,[o.value[t.value]?(y(),b("img",{key:0,src:o.value[t.value].coverUrl,class:S(["cover-img",{"cover-img-rotate":E.value,"cover-img-rotate-paused":d.value}]),alt:""},null,10,we)):$("",!0)])])]),e("div",{class:"lyric",style:U({marginTop:T(K)})},[(y(!0),b(X,null,Y(T(D).ms,(h,M)=>(y(),b("p",{class:S(["lyric-text",P.value===M?"lyric-text-current":""]),key:h.t},B(h.c),3))),128))],4)]),e("div",Ce,[e("div",Ve,[e("div",null,[e("span",Se,B((x=o.value[t.value])==null?void 0:x.name),1),e("span",Ie," - "+B((O=o.value[t.value])==null?void 0:O.author),1)]),e("div",Ne,[e("span",null,B(T(N)),1),e("span",null," / "+B(T(V)),1)])]),e("div",Le,[H(q,{modelValue:m.value,"onUpdate:modelValue":u[0]||(u[0]=h=>m.value=h),max:f.value,onChange:p,onDrag:a},null,8,["modelValue","max"])]),e("div",De,[e("div",{class:"playlist-btn iconfont icon-playlist",title:"\u64AD\u653E\u5217\u8868",onClick:r}),e("div",null,[e("span",{class:"prev iconfont icon-prev",title:"\u4E0A\u4E00\u9996",onClick:ee}),e("span",{class:S(["switch iconfont",d.value?"icon-play":"icon-pause"]),onClick:u[1]||(u[1]=h=>g()),title:d.value?"\u64AD\u653E":"\u6682\u505C"},null,10,Pe),e("span",{class:"next iconfont icon-next",title:"\u4E0B\u4E00\u9996",onClick:z})]),e("div",Me,[e("span",{class:"volume-icon iconfont icon-volume",onClick:C}),_.value?(y(),b("div",Te,[H(q,{modelValue:F.value,"onUpdate:modelValue":u[2]||(u[2]=h=>F.value=h),max:1,step:.1,vertical:""},null,8,["modelValue","step"])])):$("",!0)])])]),o.value.length>0?(y(),b("audio",{key:0,ref_key:"audio",ref:v,onCanplay:J,onTimeupdate:Q,onEnded:Z,src:o.value[t.value].url},null,40,Fe)):$("",!0)])]}),_:1}))}},je=G(Be,[["__scopeId","data-v-285954f0"]]);export{je as default};
