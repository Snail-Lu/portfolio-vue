import{_ as k}from"./index-qd-9JBwJ.js";/* empty css                     *//* empty css                    *//* empty css                */import{o as u,q as B,K as C,Y as O,f as T,b as A,k as h,c as f,w as o,a as l,_ as w,R as v,A as D,z as N,aO as j,aP as P,B as z,a0 as G,aQ as H,aA as $,y as q}from"./elementPlus-OXnB-esK.js";/* empty css                        *//* empty css                  *//* empty css                       *//* empty css                 *//* empty css                 */import{g as K}from"./date-BVJdOfRa.js";import{D as M}from"./index-CsToVXX2.js";const Q={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},S=C("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"},null,-1),Y=[S];function J(n,s){return u(),B("svg",Q,[...Y])}const W={name:"ep-plus",render:J};function X(n,s,i="a"){return new Promise(e=>{const t=new Image;t.crossOrigin="*",t.onload=function(){const a=b(t,s),c=y(a,i);e(c)},t.src=n})}function b(n,s="我是一段水印"){const{width:i,height:e}=n,t=document.createElement("canvas");t.width=i,t.height=e;const a=t.getContext("2d");a.drawImage(n,0,0,i,e),a.fillStyle="red",a.font="50px sans-serif",a.fillText(s,100,100);const U=`image/${n.src.substring(n.src.lastIndexOf(".")+1).toLowerCase()}`;return t.toDataURL(U)}function y(n,s){let i=n.split(","),e=i[0].match(/:(.*?);/)[1],t=atob(i[1]),a=t.length,c=new Uint8Array(a);for(;a--;)c[a]=t.charCodeAt(a);return new File([c],s,{type:e})}function Z(n){return new Promise((s,i)=>{let e=new FileReader;e.addEventListener("load",()=>{let t=new Image;t.src=e.result,t.addEventListener("load",()=>s(t))}),e.readAsDataURL(n)})}const ee={__name:"index",setup(n){const s={title:"图片水印",url:""},i=O(),e=T({text:K(),imgUrl:"https://t7.baidu.com/it/u=2168645659,3174029352&fm=193&f=GIF",transformedImgUrl:"",type:1});A(()=>e.type,()=>{e.transformedImgUrl=""});const t=h([]),a=h("");async function c(m){console.log(m,"upload file"),a.value=URL.createObjectURL(m.raw);let r=await Z(m.raw);const g=b(r,e.text),d=y(g,"a"),p=URL.createObjectURL(d);e.transformedImgUrl=p,t.value=[p]}async function U(){if(e.imgUrl){const m=await X(e.imgUrl,e.text),r=URL.createObjectURL(m);e.transformedImgUrl=r,t.value=[r]}else i.proxy.$message.error("请输入网络图片地址")}return(m,r)=>{const g=D,d=N,p=j,I=P,L=z,x=G,R=W,V=H,E=$,F=q;return u(),f(M,{data:s},{default:o(()=>[l(F,{model:e},{default:o(()=>[l(d,{label:"水印内容："},{default:o(()=>[l(g,{modelValue:e.text,"onUpdate:modelValue":r[0]||(r[0]=_=>e.text=_)},null,8,["modelValue"])]),_:1}),l(d,{label:"图片类型："},{default:o(()=>[l(I,{modelValue:e.type,"onUpdate:modelValue":r[1]||(r[1]=_=>e.type=_)},{default:o(()=>[l(p,{label:1},{default:o(()=>[w("网络图片")]),_:1}),l(p,{label:2},{default:o(()=>[w("本地图片")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e.type==1?(u(),f(d,{key:0,label:"图片地址："},{default:o(()=>[l(g,{modelValue:e.imgUrl,"onUpdate:modelValue":r[2]||(r[2]=_=>e.imgUrl=_)},{append:o(()=>[l(L,{onClick:U},{default:o(()=>[w("添加水印")]),_:1})]),_:1},8,["modelValue"])]),_:1})):v("",!0),e.type==2?(u(),f(d,{key:1,label:"本地图片："},{default:o(()=>[l(E,{class:"avatar-uploader",action:"#","auto-upload":!1,"on-change":c,"show-file-list":!1},{default:o(()=>[a.value?(u(),f(x,{key:0,src:a.value,class:"avatar",fit:"contain"},null,8,["src"])):(u(),f(V,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[l(R)]),_:1}))]),_:1})]),_:1})):v("",!0),l(d,{label:"水印效果："},{default:o(()=>[l(x,{style:{width:"150px",height:"150px"},src:e.transformedImgUrl,"preview-src-list":t.value,fit:"contain"},null,8,["src","preview-src-list"])]),_:1})]),_:1},8,["model"])]),_:1})}}},pe=k(ee,[["__scopeId","data-v-fb3014b6"]]);export{pe as default};
