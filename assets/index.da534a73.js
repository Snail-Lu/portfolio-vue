import{D as ee}from"./index.66c66ed1.js";import{_ as U,e as te}from"./index.f97dbc7f.js";import{h as I,k as v,z as le,o as y,m as x,D as e,J as H,u as F,y as V,I as $,O as se,b as R,f as ae,c as ne,w as oe,F as X,G as Y,H as E,a as O,K as ie,L as re,N as ce}from"./elementPlus.d15cb521.js";const ue={__name:"Slider",props:{modelValue:Number,min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},vertical:{type:Boolean,default:!1}},emits:["update:modelValue","change","drag"],setup(g,{emit:b}){const l=g,o=I(()=>l.vertical?{height:_.value}:{width:_.value}),i=I(()=>l.vertical?{bottom:_.value}:{left:_.value}),r=v(null),t=v(null),_=I(()=>(l.modelValue*100/(l.max-l.min)).toFixed(2)+"%"),S=I(()=>{const a=[l.min,l.max,l.step].map(m=>{const f=`${m}`.split(".")[1];return f?f.length:0});return Math.max.apply(null,a)}),n={};let p=0;le(()=>{const{offsetWidth:a,offsetHeight:m}=r.value;p=l.vertical?m:a});const N=a=>{a.preventDefault(),n.start=l.vertical?a.clientY:a.clientX,n.startPosition=l.modelValue/(l.max-l.min)*p,window.addEventListener("mousemove",d),window.addEventListener("mouseup",u),b("drag")},u=()=>{window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",u),b("change",l.modelValue)},d=a=>{let m=a||window.event,f=l.vertical?n.start-m.clientY:m.clientX-n.start,C=n.startPosition+f;D(C)},k=v(null),M=a=>{let m=l.vertical?k.value.getBoundingClientRect().bottom-a.clientY:a.clientX-k.value.getBoundingClientRect().left;const f=D(m);b("change",f)},D=a=>{a<0&&(a=0),a>=p&&(a=p);const m=(l.max-l.min)/l.step;let C=Math.round(a/p*m)*l.step+l.min;return C=Number.parseFloat(C.toFixed(S.value)),b("update:modelValue",C),C};return(a,m)=>(y(),x("div",{class:V([g.vertical?"slider-vertical":"slider"]),ref_key:"slider",ref:k},[e("div",{class:"slider-runway",onClick:M,ref_key:"runway",ref:r},[e("div",{class:"slider-bar",style:H(F(o))},null,4),e("div",{class:"slider-dot",style:H(F(i)),onMousedown:N,ref_key:"dot",ref:t},null,36)],512)],2))}},W=U(ue,[["__scopeId","data-v-a46cb1b5"]]);const de={class:"scroll-wrap"},ve={class:"scroll-item"},pe={__name:"AutoScrollText",props:{text:String},setup(g){return(b,l)=>(y(),x("div",de,[e("div",ve,$(g.text),1)]))}},q=U(pe,[["__scopeId","data-v-f97e39ae"]]);function me(g,b){const l=o=>{const i={ti:"",ar:"",al:"",by:"",offset:0,ms:[]};if(o.length==0)return;const r=o.split(`
`);for(let t in r){r[t]=r[t].replace(/(^\s*)|(\s*$)/g,"");let S=r[t].substring(r[t].indexOf("[")+1,r[t].indexOf("]")).split(":");if(isNaN(parseInt(S[0])))for(let n in i)n!="ms"&&n==S[0].toLowerCase()&&(i[n]=S[1]);else{const n=r[t].match(/\[(\d+:.+?)\]/g);let p=0;for(let u in n)p+=n[u].length;let N=r[t].substring(p);for(let u in n){let k=n[u].substring(1,n[u].length-1).split(":");N&&i.ms.push({t:(parseFloat(k[0])*60+parseFloat(k[1])).toFixed(3),c:N})}}}return i.ms.sort(function(t,_){return t.t-_.t}),i};return new Promise((o,i)=>{te.get(b).then(({data:r})=>{let t=l(r);o(t)}).catch(r=>{i(r)})})}const _e=g=>(ie("data-v-d75d8088"),g=g(),re(),g),fe={class:"music-container"},he=_e(()=>e("div",{class:"header flex-box flex-v-center"},[e("span",{class:"logo iconfont icon-music"}),ce(" \u97F3\u4E50\u64AD\u653E\u5668 ")],-1)),ye={class:"content"},ge={class:"playlist-item-name"},xe={class:"playlist-item-author"},be=["onClick","title"],ke={class:"disc flex-box flex-v-center flex-h-center"},we={class:"disc-outer flex-box flex-v-center flex-h-center"},Ce={class:"disc-inner"},Se=["src"],Ve={class:"footer"},Ie={class:"music-info"},Ne={class:"song-name"},De={class:"song-singer"},Le={class:"music-duration"},Te={class:"progress"},Pe={class:"controls flex-box flex-v-center flex-h-between"},$e=["title"],Fe={class:"volume"},Me={key:0,class:"volume-controls"},Be=["src"],Ee={__name:"index",setup(g){const b={title:"\u97F3\u4E50\u64AD\u653E\u5668",url:""},{proxy:l}=se(),o=v([]),i=v(0),r=()=>{i.value===1?i.value=2:i.value=1};l.req({url:"/demo/playlist"}).then(s=>{o.value=s.result.list});const t=v(0),_=v(0),S=I(()=>j(_.value)),n=v(0),p=v(0),N=I(()=>j(p.value)),u=v(!0),d=v(null),k=s=>{typeof s<"u"&&(t.value=s),d.value.paused?d.value.play():d.value.pause(),u.value=d.value.paused,z.value=!1},M=v(.2);R(M,s=>{d.value&&(d.value.volume=s)},{immediate:!0});const D=v(!1),a=s=>{D.value=!0},m=s=>{d.value.currentTime=s,D.value=!1},f=v(!1),C=()=>{f.value=!f.value},j=s=>{let c=Math.floor(s/60),w=Math.floor(s%60);return c=String(c).padStart(2,"0"),w=String(w).padStart(2,"0"),`${c}:${w}`};let L=ae({ms:[],al:"",ar:"",by:"",offset:0,ti:""});const z=v(!0),G=()=>{_.value=Math.round(d.value.duration),me("",o.value[t.value].lyricUrl).then(s=>{if(s)for(let c in s)L[c]=s[c]}),z.value||d.value.play()},T=v(0);R(n,s=>{if(L.ms&&s>0){const c=L.ms.length;if(s>parseFloat(L.ms[c-1].t))T.value=c-1;else if(T.value<c-2){let w=L.ms.findIndex(B=>s<B.t);w>0&&(T.value=w-1)}}});const J=I(()=>{if(T.value*30>=150)return-(T.value*30-150)+"px"}),K=()=>{if(D.value)return;let s=Math.round(d.value.currentTime);p.value=s,n.value=s,u.value=d.value.paused},Q=()=>{u.value=!0,n.value=0,A()},A=()=>{t.value<o.value.length-1?t.value++:t.value=0},Z=()=>{t.value>0&&t.value--};return(s,c)=>(y(),ne(ee,{data:b},{default:oe(()=>{var w,B;return[e("div",fe,[he,e("div",ye,[i.value!==0?(y(),x("div",{key:0,class:V(["playlist animate__animated animate__faster",{playlist__hidden:i.value===0,animate__slideInLeft:i.value===1,animate__slideOutLeft:i.value===2}])},[(y(!0),x(X,null,Y(o.value,(h,P)=>(y(),x("div",{class:V(["playlist-item flex-box flex-v-center",{"playlist-item-active":t.value===P}]),key:h.url},[e("div",ge,[O(q,{text:h.name},null,8,["text"])]),e("div",xe,[O(q,{text:h.author},null,8,["text"])]),e("span",{class:V(["play-btn iconfont",t.value!==P||u.value?"icon-play":"icon-pause"]),onClick:Oe=>k(P),title:t.value!==P||u.value?"\u64AD\u653E":"\u6682\u505C"},null,10,be)],2))),128))],2)):E("",!0),e("div",ke,[e("div",we,[e("div",Ce,[o.value[t.value]?(y(),x("img",{key:0,src:o.value[t.value].coverUrl,class:V(["cover-img-rotate",u.value?"cover-img-rotate-paused":""]),alt:""},null,10,Se)):E("",!0)])])]),e("div",{class:"lyric",style:H({marginTop:F(J)})},[(y(!0),x(X,null,Y(F(L).ms,(h,P)=>(y(),x("p",{class:V(["lyric-text",T.value===P?"lyric-text-current":""]),key:h.t},$(h.c),3))),128))],4)]),e("div",Ve,[e("div",Ie,[e("div",null,[e("span",Ne,$((w=o.value[t.value])==null?void 0:w.name),1),e("span",De," - "+$((B=o.value[t.value])==null?void 0:B.author),1)]),e("div",Le,[e("span",null,$(F(N)),1),e("span",null," / "+$(F(S)),1)])]),e("div",Te,[O(W,{modelValue:p.value,"onUpdate:modelValue":c[0]||(c[0]=h=>p.value=h),max:_.value,onChange:m,onDrag:a},null,8,["modelValue","max"])]),e("div",Pe,[e("div",{class:"playlist-btn iconfont icon-playlist",title:"\u64AD\u653E\u5217\u8868",onClick:r}),e("div",null,[e("span",{class:"prev iconfont icon-prev",title:"\u4E0A\u4E00\u9996",onClick:Z}),e("span",{class:V(["switch iconfont",u.value?"icon-play":"icon-pause"]),onClick:c[1]||(c[1]=h=>k()),title:u.value?"\u64AD\u653E":"\u6682\u505C"},null,10,$e),e("span",{class:"next iconfont icon-next",title:"\u4E0B\u4E00\u9996",onClick:A})]),e("div",Fe,[e("span",{class:"volume-icon iconfont icon-volume",onClick:C}),f.value?(y(),x("div",Me,[O(W,{modelValue:M.value,"onUpdate:modelValue":c[2]||(c[2]=h=>M.value=h),max:1,step:.1,vertical:""},null,8,["modelValue","step"])])):E("",!0)])])]),o.value.length>0?(y(),x("audio",{key:0,ref_key:"audio",ref:d,onCanplay:G,onTimeupdate:K,onEnded:Q,src:o.value[t.value].url},null,40,Be)):E("",!0)])]}),_:1}))}},ze=U(Ee,[["__scopeId","data-v-d75d8088"]]);export{ze as default};
